chrome.runtime.onInstalled.addListener(e=>{"install"===e.reason&&(console.log("أوقات الآذان Extension installed"),chrome.storage.local.set({calculationMethod:"4"}))});chrome.alarms.onAlarm.addListener(e=>{if(e.name.startsWith("prayer-")){const t=e.name.replace("prayer-",""),a={Fajr:"الفجر",Dhuhr:"الظهر",Asr:"العصر",Maghrib:"المغرب",Isha:"العشاء"},r=a[t]||t;chrome.notifications.create({type:"basic",title:"وقت الصلاة",message:`حان وقت صلاة ${r}`})}});function setPrayerAlarms(e){chrome.alarms.clearAll();const t=["Fajr","Dhuhr","Asr","Maghrib","Isha"],a=new Date;t.forEach(t=>{if(e[t]){const[r,n]=e[t].split(":"),i=new Date(a);i.setHours(parseInt(r),parseInt(n),0,0),i>new Date&&chrome.alarms.create(`prayer-${t}`,{when:i.getTime()})}})}chrome.runtime.onMessage.addListener((e,t,a)=>{"setPrayerAlarms"===e.action&&(setPrayerAlarms(e.prayerTimes),a({success:!0}))});